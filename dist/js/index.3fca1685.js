(function(t){function e(e){for(var s,n,a=e[0],h=e[1],l=e[2],c=0,u=[];c<a.length;c++)n=a[c],o[n]&&u.push(o[n][0]),o[n]=0;for(s in h)Object.prototype.hasOwnProperty.call(h,s)&&(t[s]=h[s]);d&&d(e);while(u.length)u.shift()();return r.push.apply(r,l||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],s=!0,a=1;a<i.length;a++){var h=i[a];0!==o[h]&&(s=!1)}s&&(r.splice(e--,1),t=n(n.s=i[0]))}return t}var s={},o={index:0},r=[];function n(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=s,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],h=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var d=h;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("c31f")},4034:function(t,e,i){"use strict";var s=i("419b"),o=i.n(s);o.a},"419b":function(t,e,i){var s=i("e574");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var o=i("499e").default;o("ed8b8868",s,!0,{sourceMap:!1,shadowMode:!1})},"4d1c":function(t,e,i){"use strict";var s=i("e52f"),o=i.n(s);o.a},c31f:function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("f751"),i("097d");var s=i("2b0e"),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("div",[t._v(t._s(this.testData))]),i("MindMapping",{attrs:{width:t.width,height:t.height,spacing:50,topColor:"#646464",fontSize:30,fontLength:10,onlyColor:!0},model:{value:t.testData,callback:function(e){t.testData=e},expression:"testData"}})],1)},r=[],n={name:"app",components:{},data:function(){return{testData:'{"x":5,"y":400,"title":"主标题","index":0,"color":"#646464","size":30,"sprites":[{"x":185,"y":-171.0703125,"title":"随机分配颜色","index":1,"color":"#e78ed9","size":24,"sprites":[]},{"x":185,"y":-95.0390625,"title":"横向间距可调节","index":1,"color":"#5119cb","size":24,"sprites":[{"x":263,"y":16.0078125,"title":"字体大小是上一级的0.8","index":2,"color":"#5119cb","size":19,"sprites":[{"x":292.40625,"y":13.5,"title":"标题文字显示有长度","index":3,"color":"#5119cb","size":15,"sprites":[]}]}]},{"x":185,"y":-19.0078125,"title":"纵向间距是标题的高","index":1,"color":"#fc7d28","size":24,"sprites":[]},{"x":185,"y":57.0234375,"title":"主要依赖svg.js","index":1,"color":"#5c3039","size":24,"sprites":[{"x":259.046875,"y":16.078125,"title":"需要安装是svgjs","index":2,"color":"#5c3039","size":19,"sprites":[]}]},{"x":185,"y":133.0546875,"title":"箭头颜色是和主标题颜色一致","index":1,"color":"#8523fa","size":24,"sprites":[{"x":355.015625,"y":16.0546875,"title":"用json保存所有的属性","index":2,"color":"#8523fa","size":19,"sprites":[]}]},{"x":185,"y":209.0859375,"title":"更新会保存所有属性","index":1,"color":"#1a4a27","size":24,"sprites":[{"x":311,"y":16.0078125,"title":"再次打开没有属性变化","index":2,"color":"#1a4a27","size":19,"sprites":[]}]}]}',width:1e3,height:800}},mounted:function(){},methods:{}},a=n,h=(i("4d1c"),i("2877")),l=Object(h["a"])(a,o,r,!1,null,null,null),d=l.exports,c=(i("8e6e"),i("ac6a"),i("456d"),i("bd86")),u=(i("7f7f"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"wTextarea",staticClass:"mindMapping",style:{width:this.editor.width+"px",height:this.editor.height+"px"}},[i("div",{ref:t.editorId,attrs:{id:t.editorId}}),this.selectId?i("div",{staticClass:"input_text",style:t.selectBoxStyle,on:{click:function(e){return t.stopDocument(e)}}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.titleData.message,expression:"titleData.message"}],staticClass:"input_message",style:t.selectInputStyle,domProps:{value:t.titleData.message},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setTitle()},input:function(e){e.target.composing||t.$set(t.titleData,"message",e.target.value)}}})]):t._e()])}),p=[],f=(i("c5f6"),i("28a5"),i("6b54"),i("6c7b"),i("d225")),g=i("b0b4"),m=function(){function t(){Object(f["a"])(this,t)}return Object(g["a"])(t,[{key:"maxFromBits",value:function(t){return Math.pow(2,t)}},{key:"getRandomInt",value:function(t,e){return Math.floor(Math.random()*(e-t+1))+t}},{key:"randomUI06",value:function(){var t=this.maxFromBits(6);return this.getRandomInt(0,t-1)}},{key:"randomUI08",value:function(){var t=this.maxFromBits(8);return this.getRandomInt(0,t-1)}},{key:"randomUI12",value:function(){var t=this.maxFromBits(12);return this.getRandomInt(0,t-1)}},{key:"randomUI16",value:function(){var t=this.maxFromBits(16);return this.getRandomInt(0,t-1)}},{key:"randomUI32",value:function(){var t=this.maxFromBits(32);return this.getRandomInt(0,t-1)}},{key:"randomUI48",value:function(){return(0|Math.random()*(1<<30))+(0|Math.random()*(1<<18))*(1<<30)}},{key:"paddedString",value:function(t,e,i){t=String(t),i=i||"0";for(var s=e-t.length;s>0;s>>>=1,i+=i)1&s&&(t=i+t);return t}},{key:"fromParts",value:function(t,e,i,s,o,r){var n=this.paddedString(t.toString(16),8)+"_"+this.paddedString(e.toString(16),4)+"_"+this.paddedString(i.toString(16),4)+"_"+this.paddedString(s.toString(16),2)+this.paddedString(o.toString(16),2)+"_"+this.paddedString(r.toString(16),12);return n}},{key:"generate",value:function(){return this.fromParts(this.randomUI32(),this.randomUI16(),16384|this.randomUI12(),128|this.randomUI06(),this.randomUI08(),this.randomUI48())}},{key:"validate",value:function(t){var e=/^[0-9a-f]{8}_[0-9a-f]{4}_4[0-9a-f]{3}_[89ab][0-9a-f]{3}_[0-9a-f]{12}$/i;return e.test(t)}}]),t}(),v=function(){function t(e,i,s,o){var r=this;Object(f["a"])(this,t),this.dom=e,this.superior=s,this.editor=o,this.data=i,this.x=i.x,this.y=i.y,this.id=i.id,this.index=i.index,this.color=i.color,this.group=e.group().move(this.x,this.y),this.sprites=[],this.width=0,this.height=0,this.font={size:i.size,weight:"bold"},this.title={tit:i.title,rect:"",text:""},this.maskBG=this.group.rect(0,0).fill(this.color).move(-2,-2).radius(10),this.title.rect=this.group.rect(0,0).fill(this.color).radius(10),this.title.text=this.group.text("").font(this.font).fill("#fff"),this.mask=this.group.rect(0,0).fill("transparent").move(0,0).attr({cursor:"pointer"}),this.addBtn=this.group.group().attr({cursor:"pointer"}),this.addBtnC=this.addBtn.circle(15).fill("#d1d3d5"),this.addBtn.text("+").font({size:15}).fill("#fff").move(3,-3),this.addBtnMask=this.addBtn.rect(15,15).fill("transparent").move(0,0);var n=function(t){r.editor.dubclickFS(t,r)},a=function(){r.maskBG.animate(200).attr({fill:"#bcbec0","fill-opacity":1}),r.title.rect.animate(200).fill("#fff"),r.title.text.animate(200).fill("#474261")},h=function(){r.maskBG.animate(200).attr({fill:r.color,"fill-opacity":1}),r.title.rect.animate(200).fill(r.color),r.title.text.animate(200).fill("#fff")};this.mask.dblclick(n),this.mask.mouseover(a),this.mask.mouseout(h);var l=function(){r.addBtnC.animate(200).attr({fill:r.color,"fill-opacity":1})},d=function(){r.addBtnC.animate(200).attr({fill:"#d1d3d5","fill-opacity":1})},c=function(){r.addSprite()};if(this.addBtnMask.mouseover(l),this.addBtnMask.mouseout(d),this.addBtnMask.click(c),this.index>0){this.pathLine=this.group.path().fill("transparent").attr({stroke:this.color,"stroke-width":3,"marker-start":"url(#"+this.editor.arrowEnd.id()+")","marker-end":"url(#"+this.editor.arrowStart.id()+")"}),this.removeBtn=this.group.group().attr({cursor:"pointer"}),this.removeBtnC=this.removeBtn.circle(15).fill("#d1d3d5"),this.removeBtn.text("-").font({size:20}).fill("#fff").move(4,-5),this.removeBtnMask=this.removeBtn.rect(15,15).fill("transparent").move(0,0);var u=function(){r.removeBtnC.animate(200).attr({fill:r.color,"fill-opacity":1})},p=function(){r.removeBtnC.animate(200).attr({fill:"#d1d3d5","fill-opacity":1})},g=function(){for(var t="",e=0;e<r.superior.sprites.length;e++){var i=r.superior.sprites[e];if(r.id==i.id){t=0==e?r.superior.sprites[1]:e==r.superior.sprites.length-1?r.superior.sprites[r.superior.sprites.length-2]:r.superior.sprites[e+1],i.group.remove(),r.superior.sprites.splice(e,1),r.settingSVGSize();break}}r.superior.spritesPosition(t),r.editor.toJsonFS()};this.removeBtnMask.mouseover(u),this.removeBtnMask.mouseout(p),this.removeBtnMask.click(g)}this.changeTitle(this.title.tit)}return Object(g["a"])(t,[{key:"changeTitle",value:function(t){var e=this,i=t.length>this.editor.fontStyle.num?t.slice(0,this.editor.fontStyle.num)+"...":t;this.title.tit=t,this.title.text.text(i),this.autoPosition().then(function(t){e.spritesPosition(t),e.editor.toJsonFS()})}},{key:"autoPosition",value:function(){var t=this.title.text.bbox(),e=t.width,i=t.height;return this.title.rect.attr({width:e+10,height:i+10}),this.maskBG.attr({width:e+14,height:i+14}),this.mask.attr({width:e+10,height:i+10}),this.title.rect.move(0,0),this.title.text.move(5,5),this.group.move(this.x,this.y-i/2),this.index>0?(this.pathLine.attr({d:this.getSuperiorLine(i)}),this.addBtn.move(e+4+15,(i+14)/2-20),this.removeBtn.move(e+4+15,(i+14)/2+5)):this.addBtn.move(e+4+15,(i+14)/2-8),this.width=e+45,this.height=i+10,this.settingSVGSize(),Promise.resolve(this)}},{key:"getSuperiorLine",value:function(t){var e={x:-20,y:Math.round((t+14)/2)},i={x:-this.editor.spacing,y:Math.round(-(this.y-(t+11)))},s=i.y-e.y,o="";s<5&&s>-5?(e.y=i.y,o=" L "+e.x+","+i.y):o=s<.6*this.editor.spacing&&s>-.6*this.editor.spacing?"\n                            Q  ".concat(i.x+.3*this.editor.spacing," , ").concat(i.y," \n                               ").concat(e.x," , ").concat(e.y,"\n            "):"\n                        Q  ".concat(i.x+.3*this.editor.spacing," , ").concat(i.y," \n                           ").concat(i.x+.3*this.editor.spacing," , ").concat(i.y>e.y?i.y-.4*this.editor.spacing:i.y+.4*this.editor.spacing,"\n                        Q  ").concat(i.x+.3*this.editor.spacing," , ").concat(e.y," \n                           ").concat(e.x-1,"  , ").concat(e.y,"\n                        L  ").concat(e.x,",").concat(e.y);var r="M "+i.x+","+i.y+o;return r}},{key:"movePosition",value:function(t){this.x=t.x||this.x,this.y=t.y||this.y,this.autoPosition()}},{key:"spritesPosition",value:function(t){var e=this,i=function t(i){e.editor.getSpriteY(i,0),i&&i.superior&&i.superior.sprites&&t(i.superior)};i(t)}},{key:"addSprite",value:function(){var t=this,e=this.width+this.editor.spacing,i=this.editor.getSpriteY(this,1),s=this.color;0==this.index&&(s=this.editor.onlyColor?this.color:"#"+Math.floor(Math.random()*(2<<23)).toString(16));var o=.8*this.font.size;o=Math.round(o),o=o>14?o:14,i.spriteY=i.spriteY-5,this.editor.addSprite({title:"创建标题",x:e,y:i.spriteY,index:this.index,dom:this.group,id:this.id+"___"+this.sprites.length,color:s,data:this,size:o}).then(function(e){t.sprites.push(e),t.spritesPosition(e),t.editor.toJsonFS()})}},{key:"settingSVGSize",value:function(){this.editor.title&&this.editor.settingSVGSize()}},{key:"getSpriteHeight",value:function(){var t=0;return this.sprites.length>1&&(t=this.sprites[0].group.bbox().height+this.sprites[this.sprites.length-1].group.bbox().height),t}},{key:"removeHeightFS",value:function(t,e){var i=t.split("___"),s=this.editor.title.sprites,o=s[s.length-1];if(0==i[1]||i[1]==s.length-1)for(var r=1;r<i.length;r++){var n=i[r];0!=n&&n!=o.sprites.length-1||(e/=2)}return e}},{key:"toJsonData",value:function(){var t={x:this.x,y:this.y,title:this.title.tit,index:this.index,color:this.color,size:this.font.size,sprites:[]};return t}}]),t}(),y=function(){function t(e,i){var s=this;Object(f["a"])(this,t),this.SVG=e,this.data=i,this.dom=this.SVG(i.domId),this.topColor=i.topColor||"#ff2970",this.width=i.width,this.height=i.height,this.oldWidth=i.width,this.oldHeight=i.height,this.onlyColor=i.onlyColor||!1,this.fontStyle={size:i.fontStyle.size||40,num:i.fontStyle.num||7},this.dubclickFS=i.dubclickFS,this.toJsonFS=i.toJsonFS,this.spacing=i.spacing||50,this.dom.size(this.width,this.height),this.iconDom=this.dom.defs(),this.arrowStart=this.iconDom.marker(6,6,function(t){t.attr({orient:"auto"}),t.path("M1,1 L5,3 L1,5 L3,3 L1,1").fill(s.topColor)}),this.arrowEnd=this.iconDom.marker(3,3,function(t){t.circle(3).fill(s.topColor)}),this.UUID=new m,this.title=new v(this.dom,{title:"创建标题",index:0,x:5,y:this.height/2,color:this.topColor,id:this.UUID.generate(),size:this.fontStyle.size||40},this,this)}return Object(g["a"])(t,[{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"fromJson",value:function(t){var e=this;if(t){t=JSON.parse(t),this.title.group.remove(),t.x=5,t.y=this.height/2,t.id=this.UUID.generate(),t.color=this.topColor,this.title=new v(this.dom,t,this,this);var i=function t(i,s){for(var o=i.sprites,r=0;r<o.length;r++){var n=o[r];n.id=s.id+"___"+r;var a=new v(s.group,n,s,e);s.sprites.push(a),n.sprites.length&&t(n,a)}};i(t,this.title)}}},{key:"toJsonData",value:function(){var t=this.title.toJsonData(),e=function t(e,i){for(var s=e,o=0;o<s.length;o++){var r=s[o];i.push(r.toJsonData()),r.sprites.length&&t(r.sprites,i[o].sprites)}return i};return e(this.title.sprites,t.sprites),JSON.stringify(t)}},{key:"addSprite",value:function(t){var e=new v(t.dom,{title:t.title,index:t.index+1,x:t.x,y:t.y,color:t.color,id:t.id,size:t.size||14},t.data,this);return Promise.resolve(e)}},{key:"settingSVGSize",value:function(){var t=this.title.group.bbox(),e=t.width,i=t.height;if(e=Math.round(e+10),i=Math.round(i+10),e=this.oldWidth>=e?this.oldWidth:e,i=this.oldHeight>=i?this.oldHeight:i,e!=this.width||i!=this.height){this.width=e,this.height=i;var s=this.oldHeight>=i?this.height/2:-t.y+this.title.height/2;this.dom.size(this.width,this.height),this.title.movePosition({y:s})}}},{key:"getSelectSprite",value:function(t){var e=[],i=function i(s){for(var o=0;o<s.length;o++){var r=s[o];if(t==r.id)return e=Object.assign({},r),e;r.sprites.length&&i(r.sprites)}};return i(this.title.sprites),e}},{key:"getSpriteY",value:function(t,e){if(t){var i=t.height/2,s=t.sprites.length;if(s){var o=t.sprites[0].height,r=s+e,n=0;r*=2*o;for(var a=0;a<s;a++){var h=t.sprites[a],l=h.getSpriteHeight()?h.getSpriteHeight()-(h.height-20):0;n+=l}for(var d=-(r+n)/2+o/2+o,c=0;c<s;c++){var u=t.sprites[c],p=d+2*o*c;c>0&&t.sprites[c-1]&&(p=t.sprites[c-1].y+(t.sprites[c-1].getSpriteHeight()?t.sprites[c-1].getSpriteHeight()/2+(t.sprites[c-1].height/2+t.sprites[c-1].height):2*t.sprites[c-1].height)),u.getSpriteHeight()&&(p+=u.getSpriteHeight()/2-20),u.movePosition({y:p,x:t.width+this.spacing})}var f=t.sprites[t.sprites.length-1].y+t.sprites[t.sprites.length-1].getSpriteHeight()/2;i=o/2+f+2*o-20}return{spriteY:i}}}}]),t}(),x={name:"MindMapping",data:function(){return{editor:"",editorId:"editor_",selectId:"",selectBoxStyle:"",selectInputStyle:"",titleData:{message:""}}},model:{prop:"value",event:"update_value"},props:{value:{type:String,default:""},width:{type:Number,default:500},height:{type:Number,default:500},spacing:{type:Number,default:50},topColor:{type:String,default:"#ff2970"},fontSize:{type:Number,default:40},fontLength:{type:Number,default:7},onlyColor:{type:Boolean,default:!1}},watch:{},computed:{},mounted:function(){var t=this,e=new m;this.editorId=this.editorId+e.generate();var i=setInterval(function(){var e=document.getElementById(t.editorId);e&&(t.editor=new y(t.$svg,{domId:t.editorId,width:t.width,height:t.height,spacing:t.spacing,topColor:t.topColor,fontStyle:{size:t.fontSize,num:t.fontLength},dubclickFS:t.editorDubclick,toJsonFS:t.toJsonFS,onlyColor:t.onlyColor}),window._TOOL=t.editor,t.value&&t.editor.fromJson(t.value),clearInterval(i))});document.onclick=function(){t.selectId=""}},methods:{editorDubclick:function(t,e){var i=this.$refs[this.editorId].getBoundingClientRect();t=t.target.getBoundingClientRect(),this.selectId=e;var s={width:t.width+"px",height:t.height+"px",top:t.y-i.y+"px",left:t.x-i.x+"px",fontSize:this.selectId.font.size+"px",fontWeight:"bold"};this.selectInputStyle=Object.assign({},s),this.selectBoxStyle=Object.assign({},s),this.titleData.message=this.selectId.title.tit,this.selectInputStyle.width=t.width-6+"px",this.selectInputStyle.height=t.height-2+"px",this.selectInputStyle.top="0px",this.selectInputStyle.left="0px"},setTitle:function(){this.selectId.changeTitle(this.titleData.message||"创建标题"),this.selectId=""},stopDocument:function(t){t.stopPropagation()},toJsonFS:function(){this.editor&&this.$emit("update_value",this.editor.toJsonData())}}},S=x,b=(i("4034"),Object(h["a"])(S,u,p,!1,null,"c0174798",null)),k=b.exports;k.install=function(t){t.component(k.name,k)};var w=k;function I(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function B(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?I(i,!0).forEach(function(e){Object(c["a"])(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):I(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var M=[w],_=function t(e){t.installed||(t.installed=!0,M.map(function(t){e.component(t.name,t)}))};"undefined"!==typeof window&&window.Vue&&_(window.Vue);var z=B({install:_},M),O=i("1929"),j=i.n(O),D={install:function(t){t.prototype.$svg=j.a}};s["a"].use(D),s["a"].use(z),s["a"].config.productionTip=!1,new s["a"]({render:function(t){return t(d)}}).$mount("#app")},d92a:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,"#app{font-family:Avenir,Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#app>div{margin:50px auto}body{margin:0}",""])},e52f:function(t,e,i){var s=i("d92a");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var o=i("499e").default;o("5512c560",s,!0,{sourceMap:!1,shadowMode:!1})},e574:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".mindMapping[data-v-c0174798]{position:relative;-webkit-box-shadow:#d8dee9 0 0 5px 0;box-shadow:0 0 5px 0 #d8dee9}.mindMapping #editorMindSVGDom[data-v-c0174798]{width:100%;height:100%}.mindMapping *[data-v-c0174798]{-webkit-user-select:none!important;-moz-user-select:none!important;-ms-user-select:none!important;user-select:none!important}.mindMapping .input_text[data-v-c0174798]{position:absolute;top:0;left:0;width:100px;height:100px;background:#fff;border-radius:8px}.mindMapping .input_text .input_message[data-v-c0174798]{padding-left:5px;outline-style:none;border:0;border-radius:8px}.mindMapping .input_text .input_message[data-v-c0174798]:focus{border:0;outline:0}",""])}});